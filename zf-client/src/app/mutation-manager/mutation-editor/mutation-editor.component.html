<div fxLayout="column" *ngIf="item">

  <mat-toolbar class="zf-mini-toolbar">
    <span class="zf-title">Mutation Editor</span>
  </mat-toolbar>

  <form [formGroup]="mfForm">
    <div fxLayout="row" fxLayoutGap="20px">

      <div fxLayout="column" fxFlex="30%">
        <mat-form-field >
          <input matInput type="text" placeholder="Gene" formControlName="gene"
                 [matAutocomplete]="autoGene"
                 maxlength="20">
        </mat-form-field>

        <mat-form-field>
          <input required type="text"  matInput placeholder="Allele" formControlName="name"
                 maxlength="20">
          <mat-error *ngIf="nameControl.touched && nameControl.invalid">{{getNameError()}}</mat-error>
        </mat-form-field>

        <mat-form-field>
          <input type="text"  matInput placeholder="Nickname" formControlName="nickname"
                 maxlength="30">
          <mat-error *ngIf="nicknameControl.touched && nicknameControl.invalid">{{getNicknameError()}}</mat-error>
          <mat-hint>Used for printing compact labels</mat-hint>
        </mat-form-field>

        <mat-form-field>
          <input matInput placeholder="Alternate Gene Name" formControlName="alternateGeneName"
                 maxlength="100">
        </mat-form-field>

        <mat-form-field >
          <input required matInput type="text" placeholder="Researcher" formControlName="researcher"
                 [matAutocomplete]="autoResearcher"
                 maxlength="20">
        </mat-form-field>

        <mat-form-field>
          <mat-select formControlName="mutationType" placeholder="Mutation Type">
            <mat-select-trigger>
              {{mfForm.controls['mutationType'].value}}
            </mat-select-trigger>
            <mat-option *ngFor="let option of service.mutationTypes" [value]="option.name">
              <div>{{option.name}} ({{option.abbrv}})</div>
              <div class="option-detail">{{option.description}}</div>
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field>
          <input matInput placeholder="Nucleotide Change" formControlName="actgChange"
                 maxlength="10">
        </mat-form-field>

        <mat-form-field>
          <input matInput placeholder="Amino Acid Change" formControlName="aaChange"
                 maxlength="10">
        </mat-form-field>

        <mat-form-field>
          <mat-select formControlName="screenType" placeholder="Generated By">
            <mat-select-trigger>
              {{mfForm.controls['screenType'].value}}
            </mat-select-trigger>
            <mat-option *ngFor="let option of service.screenTypes" [value]="option.name">
              <div>{{option.name}}</div>
              <div class="option-detail">{{option.description}}</div>
            </mat-option>
          </mat-select>
        </mat-form-field>


        <!--          2020-04-26 hidden as per request from fhcrc lab.  not used in others.-->
        <!--          <mat-form-field >-->
        <!--            <input matInput [matDatepicker]="picker" placeholder="Thaw Date" formControlName="thawDate">-->
        <!--            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>-->
        <!--            <mat-datepicker #picker></mat-datepicker>-->
        <!--          </mat-form-field>-->

        <mat-form-field>
          <mat-select placeholder="Sperm Freeze Plan" formControlName="spermFreezePlan">
            <mat-option [value]=null>--Any--</mat-option>
            <mat-option *ngFor="let i of spermFreezeOptions" [value]="i">{{i}}</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field >
          <input matInput type="number" placeholder="Vials Frozen" formControlName="vialsFrozen"
                 min="0">
        </mat-form-field>
      </div>

      <div fxLayout="column" fxLayoutGap="20px" fxFlex>
        <mat-form-field>
            <textarea matInput placeholder="Comment" formControlName="comment"
                      maxlength="3000"
                      cdkTextareaAutosize="true" cdkAutosizeMaxRows="7"></textarea>
        </mat-form-field>

        <mat-form-field>
            <textarea matInput placeholder="Phenotype" formControlName="phenotype"
                      maxlength="3000"
                      cdkTextareaAutosize="true" cdkAutosizeMaxRows="7"></textarea>
        </mat-form-field>
        <mat-form-field>
            <textarea matInput placeholder="Morphant Phenotype" formControlName="morphantPhenotype"
                      maxlength="3000"
                      cdkTextareaAutosize="true" cdkAutosizeMaxRows="7"></textarea>
        </mat-form-field>
        <div class="fill-remaining-space"></div>
        <div fxLayout="row" fxLayoutGap="20px">
          <div class="fill-remaining-space"></div>
        </div>

      </div>
    </div>
  </form>
  <div fxLayout="row" fxLayoutGap="10px">
    <div class="fill-remaining-space"></div>
    <button mat-button color="primary" (click)="cancel()">Cancel</button>
    <button mat-button color="primary" [disabled]='mfForm.pristine' (click)="revert()">Revert</button>
    <button mat-button color="primary" [disabled]='!mfForm.valid || mfForm.pristine' (click)="save()">Save</button>
  </div>
</div>

<!-- All the auto-completes gathered together to make the form easier to read. -->
<mat-autocomplete #autoGene="matAutocomplete">
  <mat-option *ngFor="let option of filteredGeneOptions | async" [value]="option">
    {{option}}
  </mat-option>
</mat-autocomplete>

<mat-autocomplete #autoResearcher="matAutocomplete">
  <mat-option *ngFor="let option of filteredResearcherOptions | async" [value]="option">
    {{option}}
  </mat-option>
</mat-autocomplete>
