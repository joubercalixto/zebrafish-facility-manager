<!-- The selector is quite different on the phone and on a big screen. -->

<!-- Filtered List Item
     Big Screen - mouse over shows more content about the item
     Phone - no mouse over.  So we try this.  If the user clicks
      once (touches), the item gets "pre-selected".  More info is displayed
      and a button comes up to let the user actually select the item.
      When "actually" selected, the whole selector toggles away and
      the selected item is viewed. -->

<div fxFlex fxLayout="column" class="zf-selector">

  <!-- The Filter part  -->
  <span class="zf-sub-title">Mutation Filter</span>
  <form [formGroup]="mfForm">


    <div fxLayout="row" fxLayoutAlign="space-between center">
      <mat-checkbox formControlName="ownedMutationsOnly" color="primary">Owned mutations only</mat-checkbox>
      <span class="fill-remaining-space"></span>
      <button (click)="onClearFilters()" color="primary" mat-button type="button">Clear Filters</button>
    </div>

    <div [fxLayout]="(appState.screenSize > ScreenSizes.MEDIUM) ? 'row' : 'column'">

      <div fxLayout="column" fxFlex="50%">

        <!--  First group of filter fields-->
        <mat-form-field>
          <label>
            <input formControlName="freeText" matInput placeholder="Search" type="text">
          </label>
          <button *ngIf="mfForm.get('freeText').value" mat-button mat-icon-button matSuffix type="button"
                  (click)="mfForm.get('freeText').setValue('')">
            <mat-icon>close</mat-icon>
          </button>
        </mat-form-field>

        <mat-form-field>
          <label>
            <input [matAutocomplete]="autoResearcher" formControlName="researcher" matInput placeholder="Source"
                   type="text">
          </label>
          <button *ngIf="mfForm.get('researcher').value" mat-button mat-icon-button matSuffix type="button"
                  (click)="mfForm.get('researcher').setValue('')">
            <mat-icon>close</mat-icon>
          </button>
        </mat-form-field>

        <mat-form-field>
          <label>
            <input [matAutocomplete]="autoMT" formControlName="mutationType" matInput placeholder="Mutation Type"
                   type="text">
          </label>
          <button *ngIf="mfForm.get('mutationType').value" mat-button mat-icon-button matSuffix type="button"
                  (click)="mfForm.get('mutationType').setValue('')">
            <mat-icon>close</mat-icon>
          </button>
        </mat-form-field>
      </div>


      <!-- Second group of filter fields -->
      <div fxLayout="column" fxFlex="50%">
        <mat-form-field>
          <label>
            <input [matAutocomplete]="autoGene" formControlName="gene" matInput placeholder="Gene" type="text">
          </label>
          <button *ngIf="mfForm.get('gene').value" mat-button mat-icon-button matSuffix type="button"
                  (click)="clearFormControl('gene')">
            <mat-icon>close</mat-icon>
          </button>
        </mat-form-field>

        <mat-form-field>
          <label>
            <input [matAutocomplete]="autoST" formControlName="screenType" matInput placeholder="Generated By"
                   type="text">
          </label>
          <button *ngIf="mfForm.get('screenType').value" mat-button mat-icon-button matSuffix type="button"
                  (click)="mfForm.get('screenType').setValue('')">
            <mat-icon>close</mat-icon>
          </button>
        </mat-form-field>

        <mat-form-field>
          <mat-select placeholder="Sperm Freeze State" formControlName="spermFreeze">
            <mat-option [value]=null>--Any--</mat-option>
            <mat-option *ngFor="let i of service.spermFreezeOptions" [value]="i">{{i}}</mat-option>
          </mat-select>
        </mat-form-field>

      </div>
    </div>
  </form>

  <!-- The Filtered List part -->
  <div class="zf-sub-title">Filtered List</div>
  <app-zf-selector-list
    (itemSelected)="onSelect($event)"
    [list]="service.filteredList"
    [service]="service"
    emptyMessage="No matches. Try relaxing the filter.">
  </app-zf-selector-list>
</div>

<!-- Auto completes grouped outside of main code for easier reading -->
<mat-autocomplete #autoGene="matAutocomplete">
  <mat-option *ngFor="let option of filteredGeneOptions | async" [value]="option">
    {{option}}
  </mat-option>
</mat-autocomplete>
<mat-autocomplete #autoResearcher="matAutocomplete">
  <mat-option *ngFor="let option of filteredResearcherOptions | async" [value]="option">
    {{option}}
  </mat-option>
</mat-autocomplete>
<mat-autocomplete #autoMT="matAutocomplete">
  <mat-option *ngFor="let option of filteredMutationTypeOptions | async" [value]="option">
    {{option}}
  </mat-option>
</mat-autocomplete>
<mat-autocomplete #autoST="matAutocomplete">
  <mat-option *ngFor="let option of filteredScreenTypeOptions | async" [value]="option">
    {{option}}
  </mat-option>
</mat-autocomplete>
