<div fxLayout="column" *ngIf="service.selected">
  <div fxLayout="column">

    <!--------------- Title and menu --------------------->
    <mat-toolbar class="zf-mini-toolbar">
      <span class="zf-title">Stock {{service.selected.name}} Details</span>
      <button mat-icon-button zfmHideUnauthorized="user" color="primary" (click)="editStock()">
        <mat-icon>edit</mat-icon>
      </button>
    </mat-toolbar>

    <div fxLayout="row" fxLayout.lt-sm="column" fxLayoutGap="10px" >
      <div fxLayout="column" fxFlex="45" >
        <!-- Main stock information-->
        <mat-form-field>
          <input matInput placeholder="Description"
                 [value]="service.selected.description" disabled>
        </mat-form-field>
        <mat-form-field>
          <input matInput placeholder="Fertilization Date"
                 [value]="service.selected.fertilizationDate +
                 ' (' + (service.selected.fertilizationDate | dateToAge) + ' days)'"
                 disabled>
        </mat-form-field>
        <mat-form-field *ngIf="!appState.getState('hidePI') && service.selected.pi">
          <input matInput placeholder="Primary Investigator"
                 [value]="service.selected.pi" disabled>
        </mat-form-field>
        <mat-form-field *ngIf="service.selected.researcher">
          <input matInput placeholder="Researcher"
                 [value]="service.selected.researcher" disabled>
        </mat-form-field>
        <mat-form-field *ngIf="service.selected.comment">
        <textarea matInput placeholder="Comment"
                  [value]="service.selected.comment"
                  cdkTextareaAutosize="true" cdkAutosizeMaxRows="7" disabled></textarea>
        </mat-form-field>

        <!-- Mom   -->
        <span class="zf-sub-title">Mom
          <button *ngIf="service.selected.matStock" mat-button color="primary"
                  (click)="goTo(service.selected.matStock.id)">{{service.selected.matStock.name}}</button>
        </span>
        <mat-form-field *ngIf="service.selected.matStock">
          <input matInput placeholder="Description"
                 [value]="service.selected.matStock.description" disabled>
        </mat-form-field>
        <div *ngIf="!service.selected.matStock">
          <mat-form-field>
            <input [value]="service.selected.externalMatId" disabled
                   matInput placeholder="External Id">
          </mat-form-field>
          <mat-form-field>
          <textarea matInput placeholder="Description"
                    cdkTextareaAutosize="true"
                    [value]="service.selected.externalMatDescription" disabled>
          </textarea>
          </mat-form-field>
        </div>

        <!-- Dad   -->
        <span class="zf-sub-title">Dad
          <button *ngIf="service.selected.patStock" mat-button color="primary"
                  (click)="goTo(service.selected.patStock.id)">{{service.selected.patStock.name}}</button>
        </span>
        <mat-form-field *ngIf="service.selected.patStock">
          <input matInput placeholder="Description"
                 [value]="service.selected.patStock.description" disabled>
        </mat-form-field>
        <div *ngIf="!service.selected.patStock">
          <mat-form-field>
            <input [value]="service.selected.externalPatId" disabled
                   matInput placeholder="External Id">
          </mat-form-field>
          <mat-form-field>
            <textarea [value]="service.selected.externalPatDescription" cdkTextareaAutosize="true"
                      disabled
                      matInput placeholder="Description">
            </textarea>
          </mat-form-field>
        </div>

        <!-- Offspring   -->
        <span class="zf-sub-title">Offspring</span>
        <mat-list *ngIf="service.selected.offspringCount < 1" dense>
          <mat-list-item>None</mat-list-item>
        </mat-list>
        <mat-list *ngIf="service.selected.offspringCount > 0" dense>
          <mat-list-item *ngFor="let kid of service.selected.offspring"
                         (mouseover)="highlightStock = kid.id"
                         (mouseleave)="highlightStock = -1"
                         class="zf-selection-item truncate" role="listitem"
                         (click)="goTo(kid.id)">
            <div mat-line>{{kid.name}} {{kid.description}}</div>
            <div *ngIf="highlightStock === kid.id">
              <app-stock-mini-viewer mat-line [stock]="kid"></app-stock-mini-viewer>
            </div>
          </mat-list-item>
        </mat-list>
      </div>
      <mat-divider vertical="true" fxHide.lt-sm></mat-divider>

      <div fxFlex=45 fxLayout="column" fxLayoutGap="10px">

        <!-- Information about mutations -->
        <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="5px">
          <span class="zf-sub-title">Mutations</span>
          <button mat-icon-button zfmHideUnauthorized="user" color="primary" (click)="editMutations()">
            <mat-icon>edit</mat-icon>
          </button>
        </div>
        <mat-list *ngIf="service.selected.mutations.length > 0" dense>
          <mat-list-item *ngFor="let m of service.selected.mutations"
                         class="zf-selection-item truncate" role="listitem"
                         (mouseover)="highlightMutation = m.id"
                         (mouseleave)="highlightMutation = -1">
            <div mat-line>{{m.fullName}}</div>
            <div mat-line *ngIf="m.id === highlightMutation">
              <app-mutation-mini-viewer [mutation]="m"></app-mutation-mini-viewer>
            </div>
          </mat-list-item>
        </mat-list>
        <mat-list *ngIf="service.selected.mutations.length < 1" dense>
          <mat-list-item>None</mat-list-item>
        </mat-list>
        <mat-divider></mat-divider>

        <!-- Information about transgenes -->
        <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="5px">
          <span class="zf-sub-title">Transgenes</span>
          <button mat-icon-button zfmHideUnauthorized="user" color="primary" (click)="editTransgenes()">
            <mat-icon>edit</mat-icon>
          </button>
        </div>
        <mat-list *ngIf="service.selected.transgenes.length > 0" dense>
          <mat-list-item *ngFor="let t of service.selected.transgenes"
                         class="zf-selection-item truncate" role="listitem"
                         (mouseover)="highlightTransgene = t.id"
                         (mouseleave)="highlightTransgene = -1">
            <div mat-line>{{t.fullName}}</div>
            <div mat-line *ngIf="t.id === highlightTransgene">
              <app-transgene-mini-viewer [transgene]="t"></app-transgene-mini-viewer>
            </div>
          </mat-list-item>
        </mat-list>
        <mat-list *ngIf="service.selected.transgenes.length < 1" dense>
          <mat-list-item>None</mat-list-item>
        </mat-list>
        <mat-divider></mat-divider>

        <!-- Information about swimmers -->
        <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="5px">
          <span class="zf-sub-title">Swimmers</span>
          <button mat-icon-button zfmHideUnauthorized="user" color="primary" (click)="editSwimmers()">
            <mat-icon>edit</mat-icon>
          </button>
        </div>
        <mat-list *ngIf="service.selected.swimmers && service.selected.swimmers.length > 0" dense>
          <mat-list-item *ngFor="let t of service.selected.swimmers">
            {{t.tank.name}}: {{t.number}} fish
            <button mat-icon-button (click)="printLabel(t.tank.id)">
              <mat-icon>print</mat-icon>
            </button>
          </mat-list-item>
        </mat-list>
        <mat-list *ngIf="service.selected.swimmers.length < 1" dense>
          <mat-list-item>None</mat-list-item>
        </mat-list>

      </div>
    </div>
  </div>
</div>
